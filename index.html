<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Memebot ‚Äî Solana</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body { font-family: Arial; background:#f5f5f5; padding:30px }
.card { background:#fff; padding:20px; max-width:700px; border-radius:8px }
label { display:block; margin-top:10px }
input, button { width:100%; padding:8px; margin-top:4px }
table { width:100%; border-collapse:collapse; margin-top:10px }
th, td { border:1px solid #ccc; padding:6px; font-size:13px }
</style>
</head>
<body>

<h2>ü§ñ Memebot ‚Äî Solana</h2>
<div class="card">
  <label>Market Cap m√≠nimo (USD)</label>
  <input id="minCap" type="number" value="30">

  <label>Valor por trade (R$)</label>
  <input id="tradeValue" type="number" value="100">

  <label>Take Profit (%)</label>
  <input id="takeProfit" type="number" value="20">

  <button onclick="startBot()">‚ñ∂Ô∏è Ligar</button>
  <button onclick="stopBot()">‚èπÔ∏è Parar</button>

  <h3>Status</h3>
  <pre id="status">---</pre>

  <h3>Simula√ß√µes</h3>
  <table>
    <thead>
      <tr>
        <th>Token</th><th>Status</th><th>Entrada</th><th>Alvo</th><th>Stop</th>
      </tr>
    </thead>
    <tbody id="rows"></tbody>
  </table>

  <h3>Lucro Total</h3>
  <b id="lucro">0</b>

  <h3>Gr√°fico</h3>
  <canvas id="grafico"></canvas>
</div>

<script>
const API = "https://memebot-dryrun.onrender.com";

async function startBot() {
  await fetch(API + "/start", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({
      network:"solana",
      minCap:Number(minCap.value),
      tradeValueBRL:Number(tradeValue.value),
      takeProfit:Number(takeProfit.value)
    })
  });
}

async function stopBot() {
  await fetch(API + "/stop", { method:"POST" });
}

const ctx = document.getElementById("grafico");
const chart = new Chart(ctx, {
  type:"line",
  data:{ labels:[], datasets:[{ label:"Lucro", data:[], borderColor:"green" }] }
});

async function sync() {
  const r = await fetch(API + "/status");
  const d = await r.json();

  status.textContent = JSON.stringify(d.config, null, 2);
  lucro.textContent = d.totalLucro.toFixed(2);

  rows.innerHTML = "";
  d.simulacoes.forEach(s=>{
    rows.innerHTML += `
      <tr>
        <td>${s.token}</td>
        <td>${s.status}</td>
        <td>${s.entrada}</td>
        <td>${s.alvo}</td>
        <td>${s.stopAtual?.toFixed(6)}</td>
      </tr>`;
  });

  chart.data.labels.push(new Date().toLocaleTimeString());
  chart.data.datasets[0].data.push(d.totalLucro);
  chart.update();
}

setInterval(sync, 5000);
sync();
</script>
</body>
</html>
